\documentclass[11pt]{article}

\input{preamble.tex}

%%
%% DOCUMENT START
%%

\begin{document}

\pagestyle{fancyplain}
\lhead{}
\chead{}
\rhead{}
\lfoot{\hrule ASEN 6519}
\cfoot{\hrule \thepage}
\rfoot{\hrule Ryan Skinner}

\noindent
{\Large Final Project}
\hfill
{\large Ryan Skinner}
\\[0.5ex]
{\large ASEN 6519: Turbulence Modelling}
\hfill
{\large Due 2015/12/15}\\
\hrule
\vspace{6pt}

\vspace{0.5in}
\begin{center}
\LARGE Implementation and Validation of the Spalart-Allmaras \\ Curvature Correction in PHASTA
\end{center}
\vspace{0.2in}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction} %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

It is well-known that the presence of rotation and streamline curvature (RC) substantially alters the physics of turbulent shear flows. \citet{bradshaw1973} notes that these changes are ``surprisingly large,'' in that they are usually ``an order of magnitude more important than normal pressure gradients and other explicit terms'' in the RANS equations for curved flows. This can lead to significant effects on shear stresses and other quantities when the stream-wise radius of curvature is as large as one hundred times the shear layer thickness \citep{bradshaw1973}. For aerodynamicists in particular, RC phenomena have high impact on boundary layer development, turbulent mixing, and heat transfer in applications ranging from flow over high-camber airfoils to rapidly-rotating turbomachinery blades.

For computational studies to effectively guide developments in design areas dominated by RC-effects, it is imperative that the turbulence models employed capture their influence in some way. Reynolds stress transport (RST) models are sometimes viewed as superior to simpler eddy-viscosity models, because RC terms appear explicitly in the Reynolds transport equation. However, this explicit influence is limited to the production term, and there appears to be little consensus on how rotation and curvature influence the other diffusion and destruction terms \citep{spalart1997}. Despite the philosophical advantages that may exist, the accuracy of full RST models comes at substantial computational cost. Accordingly, adding an RC-correction term to the latter class of models would be a boon for workflows that require rapid design iteration.

The Spalart-Allmaras (SA) one equation turbulence model captures important features of aerodynamic flows involving complex geometry and adverse pressure gradients well, and is thus one of the most appropriate eddy-viscosity models for such studies \citep{spalart1992}. However, the original model neglects the effects of streamline curvature and rotation. To remedy this, \citet{shur2000} develop an RC-correction term that scales eddy-viscosity production, giving rise to the SARC model. They validate their correction against experimental and DNS data of a number of canonical wall-bounded turbulent shear flows: 
\begin{itemize}
\item one-dimensional, fully-developed flow in a plane rotating channel,
\item one-dimensional, fully-developed flow in a curved channel,
\item two-dimensional flow in a channel with a U-turn, and
\item three-dimensional flow in a channel of rectangular cross-section with a 90\degree streamwise bend.
\end{itemize}
In all cases, the authors demonstrate substantial improvements of the SARC model over the standard SA model and in most cases the Menter two-equation shear stress transport (M-SST). These conclusions are based on predictions of mean velocity and wall shear stress distributions.

In the present project, the \citet{shur2000} curvature-correction (sans rotation terms) is added to the existing SA model in PHASTA, the Parallel Hierarchic Adaptive Stabilized Transient Analysis CFD code developed and maintained by Prof.\ Kenneth E.\ Jansen's group at the University of Colorado at Boulder. Our group focuses on aerodynamic flow control, which in many cases simplifies to ``the pursuit of bent streamlines''. Of particular interest to the author is the increased accuracy curvature-correction could bring to performance predictions of flow control strategies in an aggressive subsonic diffuser. Other applications include unsteady separation in flows over high-lift wing and tail configurations. Thus, the ability to run curvature-corrected RANS simulations will be a welcome addition to our research capabilities. To test our implementation's correctness, we simulate the 90\degree-bend case listed above, verify it using both the SA and SARC data of \citet{shur2000}, and validate it against the experimental data of \citet{kim1994}.

With the motivation clear, the remainder of this paper discusses the philosophy underpinning the mathematics of the RC-correction; the changes made to PHASTA during implementation; and the validation procedures employed, including geometry construction, meshing, and comparison to the published data mentioned above.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Spalart-Allmaras Model} %%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

As the standard Spalart-Allmaras (SA) one-equation model \cite{spalart1992} is our point of departure for the RC-correction, a brief overview is apropos.

The SA model was developed as a middle-ground between algebraic and two-equation models. It sought to address algebraic models' shortcomings in massively-separated flows, while retaining some advantages of two-equation models and forgoing their additional computational complexity. It is tuned specifically for aerodynamic flows, which can exhibit substantial separation and involve complex geometries. Its derivation starts from a blank slate; production, transport, and diffusion terms are constructed from scratch using dimensional and invariance arguments applied to four canonical flows.

Fundamentally, the SA model solves a transport equation for the pseudo-eddy-viscosity $\tilde{\nu}$, which is calibrated to behave properly within the log layer, and then scales it to the canonical eddy-viscosity $\nu_T$ in a manner consistent with the viscous sublayer. PHASTA's current version of the SA model omits the original reference's trip term\footnote{Technically, PHASTA's version of the SA model corresponds to SA-noft2 on the NASA Turbulence Modelling Resource website.}, and chooses the vorticity magnitude as the scalar norm of the deformation tensor. The model, as implemented, can be written in full detail as
\begin{align}
	\phantom{W_{ij}}
	&\begin{aligned}
		\mathllap{\pp{\tilde{\nu}}{t}}
		&+ u_j \pp{\tilde{\nu}}{x_j}
		=
		c_{b1} \tilde{\Omega} \tilde{\nu}
		-
		c_{w1} f_w \left( \frac{\tilde{\nu}}{d} \right)^2
		+
		\frac{1}{\sigma} 
		\left[
		\pp{}{x_j}
			\left( (\nu + \tilde{\nu}) \pp{\tilde{\nu}}{x_j} \right)
			+ c_{b2} \pp{\tilde{\nu}}{x_j} \pp{\tilde{\nu}}{x_j}
		\right]
		\;,
		\label{eq:SA_transport}
	\end{aligned} \\[0.5cm]
	&\begin{aligned}
		\mathllap{\nu_T} &= \tilde{\nu} f_{v1}
		&\qquad
		f_{v1} &= \frac{\chi^3}{\chi^3 + c_{v1}^3}
		&\qquad
		\chi &= \frac{\tilde{\nu}}{\nu}
		\\
		\mathllap{\tilde{\Omega}} &= \Omega + \frac{\tilde{\nu}}{\kappa^2 d^2} f_{v2}
		&\qquad
		f_{v2} &= 1 - \frac{\chi}{1 + \chi f_{v1}}
		&\qquad
		\Omega &= \sqrt{2 \omega_{ij} \omega_{ij}}
		\\
		\mathllap{\omega_{ij}} &= \frac{1}{2} \left( \pp{u_i}{x_j} - \pp{u_j}{x_i} \right)
		&\qquad
		f_w &= g \left[ \frac{1 + c_{w3}^6}{g^6 + c_{w3}^6} \right]^{1/6}
		&\qquad
		g &= r + c_{w2}(r^6 - r)
		\\
		&&&&
		r &= \min \left[ \frac{\tilde{\nu}}{\tilde{S} \kappa^2 d^2}, 10 \right]
		\;,
		\label{eq:SA_definitions}
	\end{aligned} \\[0.5cm]
	&\begin{aligned}
		\mathllap{c_{b1}} &= 0.1355
		&\quad
		c_{b2} &= 0.622
		&\quad
		\sigma &= 2/3
		&\quad
		\kappa &= 0.41
		\\
		\mathllap{c_{v1}} &= 7.1
		&\quad
		c_{w2} &= 0.3
		&\quad
		c_{w3} &= 2
		&\quad
		c_{w1} &= \frac{c_{b1}}{\kappa^2} + \frac{1 + c_{b2}}{\sigma}
		\;,
		\label{eq:SA_constants}
	\end{aligned}
\end{align}
where $d$ is the distance to the nearest wall. Because this model has been extensively summarized in prior work for this course, further exposition will be left to \citet{spalart1992}, and instead move on to a discussion of the Spalart-Shur RC-correction.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Spalart-Shur Curvature-Correction} %%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The key concepts underpinning the RC-correction were proposed by \citet{spalart1997}, and are understandably similar to those used in developing the SA model due to Spalart's hand in both formulations. Our examination of these concepts is paraphrased and condensed in large part from the aforementioned source. As a precursor, we note that descriptions of the `strength' of rotation and curvature are made relative to the shear rate and inverse shear-layer thickness, respectively.

To develop or critique any RC-correction, it is of paramount importance that one understand the mechanisms by which rotation and curvature influence turbulent flows. \citet{spalart1997} consider to two extreme cases for their model: (a) thin shear flows with weak rotation or weak curvature, and (b) homogeneous rotating shear flows, in which strong rotation eliminates the anisotropic Reynolds stresses ($\tau'_{ij} = -\overline{u_i' u_j'} \rightarrow 0$ for $i \ne j$). Intuitive reasoning based on the former suggests a non-dimensional measure of RC-effects, which the authors determine is adequate to employ in the latter case.

For analysis, we assume a statistically-stationary two-dimensional shear flow with mean velocity $\overline{u}$ in the $x$ direction and positive $\partial \overline{u} / \partial y$. We seek to understand the behavior of the Reynolds shear stress $-\overline{u'v'} > 0$, in order to clarify its effects on the eddy-viscosity-based SA model. To correct the Reynolds stress transport equation (RSTE) for reference frame rotation, one must add the term
\begin{equation}
2 \Omega'_k \big( \overline{u'_j u'_m} \epsilon_{ikm} + \overline{u'_i u'_m} \epsilon_{jkm} \big)
\quad \rightarrow \quad
2 \Omega' \big( \overline{u'^2} - \overline{v'^2} \big)
\;,
\end{equation}
where $\Omega'$ is the rotation rate about the $z$-axis, and the simplification applies to our two-dimensional shear flow. Since the stream-wise fluctuations are greater than their span-wise counterparts, the Coriolis term increases production of shear stress when $\Omega' > 0$, and vice versa. Curvature produces a similar term in the RSTE. We conclude that the means by which Reynolds stresses (and through the Boussinesq hypothesis, eddy-viscosity $\nu_T$) are enhanced or diminished in RC-present flows are subtle and not readily captured by standard eddy-viscosity models.

To maintain the original SA model's strengths, any indicator of rotation and curvature we devise must be invariant under Galilean transformations. Since $\overline{u'^2} > \overline{v'^2}$ is the defining turbulent characteristic of our shear flow, it is natural to question what it implies of some standard Galilean invariants of fluid dynamics. As \citet{spalart1997} discuss, this inequality describes a relationship between between the principal axes of the Reynolds stress tensor $\tau'_{ij}$ and the strain tensor $S_{ij} = \tfrac{1}{2} (u_{i,j} + u_{j,i})$. Depending on the system's rotation direction, the stress axes lag or lead the strain axes. Recall that in turbulent flows, the stress axes respond ``slowly'' to turbulent fluctuations, whereas the strain axes respond ``rapidly.'' Based on these tensors' disparate rates of change, in situations where $\tau'_{ij}$ leads $S_{ij}$, the rotation tends to align the them with each other, plausibly increasing turbulence production. This mechanism is the central basis of the SARC model, which scales turbulent production based on the alignment of these tensors.

It remains to devise a quantitative measure of the degree to which turbulent stress and strain are leading or lagging each other. Such an indicator will ideally recognize the common physical basis of curvature and rotation effects. In the two-dimensional case, \citet{spalart1997} decide to track the direction of the principal axes of the strain tensor. Defining the angle $\alpha$ as the direction of strain tensor principal axes relative to an inertial frame, the total derivative $D \alpha / D t$ is chosen. Considering $D \alpha / D t$ physically, it is apparent that it both tracks curvature and rotation effects, and is Galilean invariant. Note that in a two-dimensional rotating homogeneous flow, $D \alpha / D t = \Omega'$. Our present discussion is predicated upon the existence of principal strain directions. Situations in which $S_{ij}$ is isotropic result in undefined $\alpha$, and mitigation strategies will be discussed shortly.

In the full three-dimensional case, the principal directions cannot be easily determined from algebraic manipulations, and the rotation angle $\alpha$ becomes a rotation angle vector. To obtain an invariant similar to $D \alpha / D t$ while addressing these additional complexities, \citet{spalart1997} consider the double contraction 
\begin{equation}
\DD{S_{ij}}{t} \frac{\delta S_{ij}}{\delta t}
\label{eq:double_conraction}
\end{equation}
to be a prime candidate, where $\delta S_{ij} / \delta t$ is defined as the point-wise rotation of the strain rate tensor at a rate given by the vorticity vector. Symmetry considerations reveal that this expression depends only on the curl of the velocity field, which is consistent with a quantity targeting only rotation and curvature effects. After normalizing the magnitude using $D$, an average of the strain and vorticity norms, and including system rotation effects in a similar manner to the two-dimensional case, a scalar measure of RC-effects in three dimensions can be written as
\begin{equation}
\tilde{r} = \frac{2 \omega_{ik} S_{jk}}{D^4}
\left( \frac{D S_{ij}}{D t} + \Omega'_m (\epsilon_{imn} S_{jn} + \epsilon_{jmn} S_{in}) \right)
\;.
\end{equation}
The connection to \eqref{eq:double_conraction} is clear from the nature of the contraction and the presence of vorticity from $\delta S_{ij} / \delta t$. The second derivatives of velocity present in $D S_{ij} / D t$ should not be taken lightly, since they add complexity to the computational implementation. Nonetheless, \citet{spalart1997} find no reasonable approximations to $\tilde{r}$ that can be calculated using only first derivatives.

Increased computational demand aside, $\tilde{r}$ can be used to construct a scaling function applied to the production term of the SA model. In our PHASTA implementation, we assume a stationary reference frame, setting $\Omega'_m = 0$ and allowing Coriolis terms to vanish. The only modification required to the standard SA model is to multiply the production term $c_{b1} \tilde{S} \tilde{\nu}$ in \eqref{eq:SA_transport} by a rotation function $f_{r1}$, where
\begin{align}
	&\begin{aligned}
		\mathllap{f_{r1}} = (1 + c_{r1}) \frac{2 r^*}{1 + r^*} \left[ 1 - c_{r3} \arctan(c_{r2} \tilde{r}) \right] - c_{r1}
		\;
		\label{eq:SARC_rotation_function}
	\end{aligned}\\[0.25cm]
	\phantom{f_{r1}}
	&\begin{aligned}
		\mathllap{r^*} &= S / \Omega
		\; &\qquad
		\tilde{r} &= \frac{2 \omega_{ik} S_{jk}}{D^4} \left( \frac{D S_{ij}}{D t} \right)
		\; &\qquad
		S_{ij} &= \frac{1}{2} \left( \pp{u_i}{x_j} + \pp{u_j}{x_i} \right)
		\; \\
		\mathllap{S^2} &= 2 S_{ij} S_{ij}
		\; &\qquad
		\Omega^2 &= 2 \omega_{ij} \omega_{ij}
		\; &\qquad
		D^2 &= (S^2 + \Omega^2) / 2
		\label{eq:SARC_definitions}
	\end{aligned}\\[0.25cm]
	&\begin{aligned}
		\mathllap{c_{r1}} &= 1.0
		\; \quad
		c_{r2} = 12
		\; \quad
		c_{r3} = 1.0
		\;.
		\label{eq:SARC_constants}
	\end{aligned}
\end{align}
This rotation function protects against the case of isotropic stresses mentioned above; though $\tilde{r}$ may blow up as the strain tensor vanishes, $f_{r1}$ effectively turns itself off through the $r^*$ terms. Note that for our original example of shear flows with no curvature, $r^* = 1$, $\tilde{r} = 0$, and the constraint that the original SA model be recovered through $f_{r1} \rightarrow 1$ is satisfied. The model constants are tuned using joint numerical-experimental data from \citet{dacles1995}. \citet{shur2000} note that these constants are still being tuned, and that for a backward-facing step, they found a value of $c_{r3} = 0.6$ instead of 1 to be more appropriate. Nonetheless, the NASA Turbulence Modelling Resource website lists the values given in \eqref{eq:SARC_constants} as reliable, and we use them accordingly in our own implementation.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{PHASTA Implementation} %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Since the standard SA model has already been implemented in PHASTA, our only task is to calculate and pre-multiply its production term by $f_{r1}$. The material derivative of the strain tensor, $DS_{ij}/Dt$, in \eqref{eq:SARC_definitions} made this process slightly more complicated than initially anticipated, but not overly so. Because this is the author's first major foray into the source of PHASTA, the decision was made to limit modifications to the incompressible code. In this section, we describe the process used to compute $f_{r1}$.

\subsection{Finite Element Preliminaries}

Because Spalart-Allmaras is a one-equation model, it requires solution of an additional transport equation for the eddy-viscosity $\nu_T$, in addition to the Navier-Stokes equations. The strong form of the eddy-viscosity transport equation specified in the SA model includes source, convection, and diffusion terms. To translate it into the finite element method's framework, the scalar transport equation is pre-multiplied by a weight function and integrated over the domain. Terms with second-order derivatives, such as diffusion, are integrated by parts to reduce the order of spatial derivatives that must be computed. The SA production term,
\begin{equation}
c_{b1}
\tilde{\nu}
\left( \sqrt{2 \omega_{ij} \omega_{ij}} + f_{v2} \frac{\tilde{\nu}}{\kappa^2 d^2} \right)
\;,
\end{equation}
is just a scalar quantity with no encompassing derivatives, so its only contribution to the weak form residual comes from a spatial integral. No integration by parts is needed, so no surface integrals are affected by the source term.

After localizing the weak form equation to elements, it is apparent that the production term is only evaluated at the quadrature points used for numerical integration. Thus, the most straightforward implementation of the Spalart-Shur curvature correction involves computing the $f_{r1}$ production scaling factor only at quadrature points. Accordingly, any nodal quantities that act as arguments to $f_{r1}$ must be interpolated to these quadrature points. This process is standard in finite elements. Given nodal values $\phi_A^e$ and shape functions $N^e_A(\mb{x}^e)$, the interpolated value $\phi(\mb{x}^e)$ at local coordinate $\mb{x}^e$ can be expressed as the sum
\begin{equation}
\phi(\mb{x}^e) = \sum_A N^e_A(\mb{x}^e) \: \phi_A^e
\;,
\end{equation}
where the superscript $e$ indicates quantities localized to an element. Furthermore, the first derivative of that variable with respect to some coordinate $x_i$ can be written in terms of shape function derivatives:
\begin{equation}
\pp{\phi(\mb{x}^e)}{x_i} = \sum_A \left(\pp{N}{x_i}\right)^e_A \! (\mb{x}^e) \: \phi_A^e
\;.
\label{eq:fem_first_derivs}
\end{equation}
These formulae will be used routinely to compute arguments of $f_{r1}$ at quadrature points.

Because PHASTA uses linear shape functions, computing spatial second-derivatives is non-trivial. This raises the question of how we intend to compute such derivatives of velocity for the curvature-correction's $D S_{ij} / D t$ strain gradient terms.  Their computation is aided by a projection-reconstruction approach, which proceeds as follows, given nodal values of a scalar $\phi$:
\begin{enumerate}
\item The slope $\partial \phi / \partial x_i$ is computed between neighboring nodes, projecting a derivative field onto the elements.
\item Slopes computed for neighboring elements are averaged together, reconstructing a nodal representation of $\partial \phi / \partial x_i$.
\end{enumerate}
To obtain spatial second-derivatives, \eqref{eq:fem_first_derivs} can be applied to the reconstructed field. Fortunately, a nodal reconstruction of a scaled $S_{ij}$ is already computed during each flow solve, and can be made readily accessible to our scalar solve routines.

\subsection{Changes to Source Code}

We begin with general book-keeping changes to the code. First, the ``\li{RANS-SARC}'' model was added as an option to \li{input_fform.c}, and assigned an identifying \li{iRANS} integer of \li{-3}. Since all machinery within the existing SA code will also be used in the curvature-corrected model, any if-statement that activates for the standard SA model (identified by an \li{iRANS} code of \li{-1}), is also changed to activate for the curvature-corrected model. Spalart-Shur constants from \eqref{eq:SARC_constants} are added to \li{turbsa.f}.

The main terms involved in $f_{r1}$, shown in \eqref{eq:SARC_definitions}, need to be accessible to the main computation of the eddy-viscosity, also known as the turbulence scalar, source term in \li{e3sourceSclr}. The next changes to the PHASTA source we discuss facilitate this need. As mentioned in the previous subsection, we require the nodal reconstruction of $S_{ij}$ in order to compute its spatial derivative. The reconstruction is called \li{qres}, and its global representation is computed in the flow solve's \li{ElmGMR} routine. We pass the variable up through \li{SolFlow} to \li{itrdrv}, and then down through the increasingly-specific scalar solve routines until we reach \li{e3sourceSclr}. The stack of function calls, starting from \li{itrdrv}, is:
\begin{itemize}
\item \li{SolSclr}
\item \li{ElmGMRSclr}
\item \li{AsIGMRSclr}
\item \li{e3Sclr}
\item \li{e3ivarSclr}
\item \li{e3sourceSclr}
\end{itemize}

 We can write the proper definition of $DS_{ij}/Dt$ as
\begin{equation}
\DD{S_{ij}}{t}
\equiv
\left( \pp{}{t} + u_k \pp{}{x_k} \right) S_{ij}
=
\frac{1}{2}
\left( \pp{}{t} + u_k \pp{}{x_k} \right)
\left( \pp{u_i}{x_j} + \pp{u_j}{x_i} \right)
\;,
\end{equation}
from which it is clear that we need to compute two kinds of terms within the code: the temporal derivatives and spatial gradients of the velocity gradient tensor $\partial u_i / \partial x_j$.

For the temporal term, the continuum assumption allows us to interchange the order of differentiation, so
\begin{equation}
\pp{}{t} \pp{u_i}{x_j}
=
\pp{}{x_j} \pp{u_i}{t}
=
\pp{}{x_j} a_i
\;.
\end{equation}
Here, $a_i$ is the fluid acceleration, which is already computed during each flow solve of PHASTA. The spatial derivatives of $a_i$ can then be computed using shape function gradients in the manner standard to finite element analysis. That is, taking the sum of shape function gradients 

reconstructed velocity one is qres, coming from the flow solve. qres is a nodally-reconstructed field of d v / d x

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Model Validation} %%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[h!]
\centering
\includegraphics[width=0.48\textwidth]{Cf_Inside_Comparison.png}
\includegraphics[width=0.48\textwidth]{Cf_Outside_Comparison.png}
\caption{Blep blep blep.}
\label{fig:Cf_Centerlines}
\end{figure}

\begin{figure}[h!]
\centering
\includegraphics[width=0.32\textwidth]{Cf_U1.png}
\includegraphics[width=0.32\textwidth]{Cf_U2.png}\\
\includegraphics[width=0.32\textwidth]{Cf_15.png}
\includegraphics[width=0.32\textwidth]{Cf_45.png}
\includegraphics[width=0.32\textwidth]{Cf_75.png}\\
\includegraphics[width=0.32\textwidth]{Cf_D1.png}
\includegraphics[width=0.32\textwidth]{Cf_D2.png}
\caption{Blep blep blep.}
\label{fig:Cf_Centerlines}
\end{figure}

\begin{figure}[h!]
\centering
\includegraphics[width=0.32\textwidth]{vel_U1.png}
\includegraphics[width=0.32\textwidth]{vel_U2.png}\\
\includegraphics[width=0.32\textwidth]{vel_15.png}
\includegraphics[width=0.32\textwidth]{vel_45.png}
\includegraphics[width=0.32\textwidth]{vel_75.png}\\
\includegraphics[width=0.32\textwidth]{vel_D1.png}
\includegraphics[width=0.32\textwidth]{vel_D2.png}
\caption{Blep blep blep.}
\label{fig:velocity_slices}
\end{figure}

\begin{figure}[h!]
\centering
\includegraphics[width=0.75\textwidth]{EV_Comparison_Full_U1_15.png}\\
\includegraphics[width=0.75\textwidth]{EV_Comparison_Full_15_45_75.png}\\
\includegraphics[width=0.75\textwidth]{EV_Comparison_Full_75_D1_D2.png}
\caption{Blep blep blep.}
\label{fig:ev_lines}
\end{figure}

\begin{figure}[h!]
\centering
\includegraphics[width=0.9\textwidth]{SA-v-SARC_EddyVisc.png}
\caption{Blep blep blep.}
\label{fig:ev_slices}
\end{figure}

\begin{figure}[h!]
\centering
\includegraphics[width=\textwidth]{SA-v-SARC_WallShearStress.png}
\caption{Blep blep blep.}
\label{fig:wss}
\end{figure}

\begin{figure}[h!]
\centering
\includegraphics[width=\textwidth]{TuningMesh_Long_yplus.png}
\caption{Blep blep blep.}
\label{fig:wss}
\end{figure}

\begin{figure}[h!]
\centering
\includegraphics[width=\textwidth]{meshes_far.png}
\includegraphics[width=\textwidth]{meshes_zoom.png}
\caption{Blep blep blep.}
\label{fig:mesh_overview}
\end{figure}

\begin{figure}[h!]
\centering
\includegraphics[width=0.7\textwidth]{meshes_bls.png}
\caption{Blep blep blep.}
\label{fig:mesh_bls}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Appendix A: PHASTA Code} %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

All changes discussed here pertain to the incompressible code, including files common to both incompressible and compressible branches when appropriate.

In \li{input_fform.f}, the entry \li{RANS-SARC} is added to represent this turbulence model in \li{input.config}.

\bibliographystyle{plainnat}
\bibliography{sources}

%%
%% DOCUMENT END
%%
\end{document}
